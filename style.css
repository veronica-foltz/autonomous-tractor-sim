/* Layout */
* { box-sizing: border-box; }
:root {
  --bg:#0b1222; --panel:#0f172a; --muted:#94a3b8; --line:#243041;
  --txt:#e5eefb; --green:#22c55e; --blue:#38bdf8; --yellow:#facc15; --pink:#e879f9;
  --btn:#1f2937; --btn-h:#2b3a52; --primary:#3b82f6; --accent:#a78bfa;
}
html,body { height:100%; }
body { margin:0; background:var(--bg); color:var(--txt); font:15px/1.4 system-ui, Arial, sans-serif; }

.container { width:min(1024px, 92vw); margin:0 auto; }
.title { font-size:32px; margin:20px 0 4px; letter-spacing:.2px; }
.subtitle { margin:0 0 16px; color:var(--muted); }

.panel {
  background:var(--panel);
  border:1px solid var(--line);
  border-radius:14px;
  padding:12px;
  box-shadow: 0 8px 24px rgba(0,0,0,.25);
}

/* Toolbar */
.toolbar { display:grid; gap:10px; grid-template-columns: 1fr 1fr 1fr; align-items:center; }
.group { display:flex; gap:8px; flex-wrap:wrap; }

.btn {
  background:var(--btn); color:var(--txt); border:1px solid var(--line);
  padding:8px 12px; border-radius:10px; cursor:pointer; font-weight:700;
}
.btn:hover { background:var(--btn-h); }
.btn-primary { background:var(--primary); border-color:transparent; }
.btn-primary:hover { filter:brightness(1.05); }
.btn-accent { background:var(--accent); border-color:transparent; color:#0b1020; }
.btn:disabled { opacity:.5; cursor:not-allowed; }

.btn-danger {
  background:#ef4444;
  border-color:transparent;
  color:#fff;
}
.btn-danger:hover { filter:brightness(1.1); }

.field { display:flex; align-items:center; gap:10px; background:#0b1020; padding:6px 10px; border-radius:10px; border:1px solid var(--line); color:var(--muted); }
.field input[type="range"] { width:160px; accent-color: #8b93ff; }

/* Modes segmented */
.modes { display:flex; align-items:center; justify-content:space-between; gap:12px; }
.segmented { display:inline-flex; background:#0b1020; border:1px solid var(--line); border-radius:12px; overflow:hidden; }
.segmented label { position:relative; }
.segmented input { position:absolute; inset:0; opacity:0; }
.segmented span {
  display:inline-block; padding:8px 12px; color:var(--muted); cursor:pointer; user-select:none;
}
.segmented input:checked + span { background:#1b2436; color:var(--txt); }

/* Canvas */
.canvas-wrap { padding:10px; }
#grid { display:block; width:100%; height:auto; background:#0b1020; border:2px solid var(--line); border-radius:12px; }

/* Legend chips */
.legend { display:flex; gap:8px; flex-wrap:wrap; color:var(--muted); }
.chip { padding:6px 10px; border-radius:999px; border:1px solid var(--line); }
.chip.start   { background:color-mix(in srgb, var(--green) 25%, transparent); }
.chip.goal    { background:color-mix(in srgb, var(--blue) 25%, transparent); }
.chip.rock    { background:#303a4a; }
.chip.path    { background:color-mix(in srgb, var(--yellow) 25%, transparent); color:#111; }
.chip.tractor { background:color-mix(in srgb, var(--pink) 25%, transparent); }

/* Stats */
.stats { display:grid; gap:10px; grid-template-columns: repeat(5, minmax(120px,1fr)); align-items:center; }
.stat { background:#0b1020; border:1px solid var(--line); border-radius:10px; padding:8px 10px; text-align:center; color:var(--txt); }
.progress { grid-column: 1 / -1; height:10px; background:#0b1020; border:1px solid var(--line); border-radius:999px; overflow:hidden; }
.bar { height:100%; background:linear-gradient(90deg, var(--green), var(--yellow)); width:0%; }

/* Status & footer */
.status { margin-top:12px; color:var(--muted); font-weight:600; }
.footer { color:var(--muted); text-align:center; padding:20px 0 40px; }

.legend { display: none !important; }

/* Mobile */
:root { --mobile-pad: 10px; }
body { -webkit-tap-highlight-color: transparent; }
.title { font-size: clamp(22px, 6.5vw, 32px); line-height: 1.15; margin-top: 16px; }
.subtitle { font-size: clamp(13px, 3.8vw, 16px); }

#grid { width: 100%; height: auto; image-rendering: pixelated; }

@media (max-width: 768px) {
  .container { width: min(100%, 96vw); padding-left: 2vw; padding-right: 2vw; }
  .panel { padding: var(--mobile-pad); border-radius: 12px; }
}

@media (max-width: 768px) {
  .toolbar { grid-template-columns: 1fr; gap: 12px; }
  .group { width: 100%; justify-content: stretch; }
  .btn { width: 100%; padding: 12px 14px; border-radius: 12px; }
  .btn + .btn { margin-left: 0; } /* avoid crowded rows */
  .field { width: 100%; justify-content: space-between; padding: 10px 12px; }
  .field input[type="range"] { width: 58vw; } /* prevent slider from overflowing */
}

@media (max-width: 768px) {
  .modes { flex-direction: column; align-items: stretch; gap: 10px; }
  .segmented { width: 100%; overflow-x: auto; -webkit-overflow-scrolling: touch; }
  .segmented span { padding: 10px 14px; }
}

@media (max-width: 768px) {
  .stats { grid-template-columns: repeat(2, 1fr); gap: 8px; }
  .progress { grid-column: 1 / -1; height: 12px; }
}
@media (max-width: 380px) {
  .stats { grid-template-columns: 1fr; }
}

@media (max-width: 768px) {
  .legend { display: none; }
}

/* MOBILE FIX */
@media (max-width: 700px) {
  /* stack the whole toolbar */
  .toolbar { 
    display: flex !important;           /* override grid */
    flex-direction: column !important;
    gap: 12px !important;
  }

  /* each group takes full width and stacks its children */
  .toolbar .group { 
    width: 100% !important;
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
  }

  /* buttons */
  .btn { width: 100% !important; padding: 12px 14px !important; border-radius: 12px; }

  /* slider rows */
  .field { 
    width: 100% !important;
    display: flex !important;
    align-items: center !important;
    justify-content: space-between !important;
    gap: 12px !important;
    padding: 10px 12px !important;
  }
  .field span { flex: 0 0 140px !important; }       
  .field input[type="range"] { flex: 1 1 auto !important; width: auto !important; }

  /* canvas*/
  #grid { width: 100% !important; height: auto !important; image-rendering: pixelated; }

  /* stats*/
  .stats { grid-template-columns: 1fr 1fr !important; gap: 8px !important; }
  .progress { grid-column: 1 / -1 !important; height: 12px !important; }

  .title { font-size: clamp(22px, 6.5vw, 32px); line-height: 1.15; margin: 12px 0 6px; }
  .subtitle { font-size: clamp(13px, 3.8vw, 16px); margin-bottom: 12px; }

  .legend { display: none !important; }
}
